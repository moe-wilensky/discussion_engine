<!-- Mutual Removal Confirmation Dialog (Modal) -->
<div id="mutual-removal-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen px-4">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Confirm Mutual Removal</h3>
            
            <div class="mb-6">
                <p class="text-sm text-gray-700 mb-4">
                    You are about to initiate mutual removal with <span id="target-username" class="font-semibold"></span>.
                </p>
                
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                    <p class="text-sm text-yellow-800 font-medium mb-2">⚠️ Consequences:</p>
                    <ul class="text-sm text-yellow-700 space-y-1 list-disc list-inside">
                        <li>Both you and <span id="target-username-2"></span> will become temporary observers</li>
                        <li>You will rejoin after <span id="mrp-period">1 MRP</span></li>
                        <li>This action cannot be undone</li>
                    </ul>
                </div>
                
                <div id="escalation-warning" class="bg-red-50 border border-red-200 rounded-lg p-4 hidden">
                    <p class="text-sm text-red-800 font-medium mb-2">⚠️ Escalation Warning:</p>
                    <p class="text-sm text-red-700">
                        You have used <span id="removal-count" class="font-bold"></span> of 3 allowed removals.
                        <span id="permanent-warning" class="hidden">
                            <strong>If you initiate 3 removals, you will become a permanent observer and lose all platform invites.</strong>
                        </span>
                    </p>
                </div>
            </div>
            
            <form method="post" id="removal-form">
                {% csrf_token %}
                <input type="hidden" name="target_user_id" id="target-user-id">
                <input type="hidden" name="action" value="mutual_removal">
                
                <div class="flex justify-end gap-3">
                    <button 
                        type="button" 
                        onclick="closeMutualRemovalModal()"
                        class="btn btn-outline"
                    >
                        Cancel
                    </button>
                    <button 
                        type="submit" 
                        class="btn btn-danger"
                    >
                        Confirm Removal
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function showMutualRemovalModal(targetUserId, targetUsername, removalCount, mrpPeriod) {
    document.getElementById('target-user-id').value = targetUserId;
    document.getElementById('target-username').textContent = targetUsername;
    document.getElementById('target-username-2').textContent = targetUsername;
    document.getElementById('mrp-period').textContent = mrpPeriod;
    document.getElementById('removal-count').textContent = removalCount;
    
    if (removalCount >= 2) {
        document.getElementById('escalation-warning').classList.remove('hidden');
        if (removalCount === 2) {
            document.getElementById('permanent-warning').classList.remove('hidden');
        }
    }
    
    document.getElementById('mutual-removal-modal').classList.remove('hidden');
}

function closeMutualRemovalModal() {
    document.getElementById('mutual-removal-modal').classList.add('hidden');
}
</script>
